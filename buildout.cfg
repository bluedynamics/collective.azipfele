[buildout]

find-links +=
    http://effbot.org/downloads/

parts =
    robot
    test
    instance


extends = http://dist.plone.org/release/4.3-latest/versions.cfg
unzip = true
develop = .

extensions += mr.developer
sources-dir = ${buildout:directory}/devsrc
auto-checkout = *
always-checkout = force
always-accept-server-certificate = true


[test]
recipe = zc.recipe.testrunner
defaults = ['--auto-color', '--auto-progress']
eggs =
   bda.azipfele[test]



[versions]
collective.zamqp = >=0.12.0



[vars]
rabbitmq-host = 127.0.0.1
rabbitmq-port = 5672
rabbitmq-user = guest
rabbitmq-pass = guest
nginx-sendfile = /zlag_mediadb
zipfiles = ${buildout:directory}/var




# Tests
plone.app.robotframework = 0.9.2
selenium = >=2.39.0
robotframework = >= 2.8.4
robotsuite = >=1.4.3
Pillow = >=2.3.0


[robot]
recipe = zc.recipe.egg
eggs =
    Pillow
    ${test:eggs}
    plone.app.robotframework



[instance]
recipe = plone.recipe.zope2instance
http-address = 8080
user = admin:admin

zeo-client = on
zeo-address = ${zeoserver:zeo-address}
shared-blob = on

eggs =
    bda.azipfele
    plone.reload
    ipdb
    Products.PrintingMailHost

zcml =
    bda.azipfele


environment-vars =
    BDA_AZIPFELE_ZIPS ${vars:zipfiles}
    BDA_AZIPFELE_NGINX ${vars:nginx-sendfile}

zope-conf-additional =
    %import collective.zamqp
    <amqp-broker-connection>
        connection_id superuser
        hostname ${vars:rabbitmq-host}
        port ${vars:rabbitmq-port}
        username ${vars:rabbitmq-user}
        password ${vars:rabbitmq-pass}
        heartbeat 120
    </amqp-broker-connection>



[worker]
<=instance
http-address = 8081

zope-conf-additional =
    %import collective.zamqp
    <amqp-broker-connection>
        connection_id superuser
        hostname ${vars:rabbitmq-host}
        port ${vars:rabbitmq-port}
        username ${vars:rabbitmq-user}
        password ${vars:rabbitmq-pass}
        heartbeat 120
    </amqp-broker-connection>
    <amqp-consuming-server>
        connection_id   superuser
        site_id         Plone
        user_id         admin
    </amqp-consuming-server>

[zeoserver]
recipe = plone.recipe.zeoserver
zeo-address = localhost:8100
file-storage = ${buildout:directory}/var/filestorage/Data.fs
blob-storage = ${buildout:directory}/var/blobstorage

